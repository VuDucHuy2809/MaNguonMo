{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/\\u0110\\u1ED3 \\xE1n M\\xE3 Ngu\\u1ED3n M\\u1EDF/MaNguonMo/DoAn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/xampp/htdocs/\\u0110\\u1ED3 \\xE1n M\\xE3 Ngu\\u1ED3n M\\u1EDF/MaNguonMo/DoAn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/xampp/htdocs/\\u0110\\u1ED3 \\xE1n M\\xE3 Ngu\\u1ED3n M\\u1EDF/MaNguonMo/DoAn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{Link}from'react-router-dom';import Rating from'./Rating';import React,{useEffect,useState,useReducer,useContext}from'react';import{Store}from'../../../Store';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProductsMain2(props){var product=props.product;var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cartItems=state.cart.cartItems;var addToCartHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var existItem,quantity,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:existItem=cartItems.find(function(x){return x._id===product._id;});quantity=existItem?existItem.quantity+1:1;_context.next=4;return axios.get(\"/api/products/\".concat(product._id));case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context.next=9;break;}window.alert('Sorry . Product is out if stock');return _context.abrupt(\"return\");case 9:ctxDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});case 10:case\"end\":return _context.stop();}}},_callee);}));return function addToCartHandler(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3 new-collections-grid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"new-collections-grid1 animated wow slideInUp\",\"data-wow-delay\":\".5s\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"new-collections-grid1-image\",children:[/*#__PURE__*/_jsx(Link,{to:\"products/\".concat(product.slug),className:\"product-image\",children:/*#__PURE__*/_jsx(\"img\",{src:product.image,alt:product.name,className:\"img-responsive\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"new-collections-grid1-image-pos\",children:/*#__PURE__*/_jsx(Link,{to:\"products/\".concat(product.slug),children:\"Quick View\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"new-collections-grid1-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rating\",children:[/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews}),/*#__PURE__*/_jsx(\"div\",{className:\"clearfix\",children:\" \"})]})})]}),/*#__PURE__*/_jsx(\"h4\",{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(product._id),children:product.name})}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"div\",{className:\"new-collections-grid1-left simpleCart_shelfItem\",children:product.countInStock<=0?/*#__PURE__*/_jsx(\"span\",{class:\"badge bg-success\",children:\"on Stock\"}):/*#__PURE__*/ // <p><i>$340</i> <span className=\"item_price\">${product.price}</span><button className='btnAdd' onClick={() => addToCartHandler(product)}><p><a>Add sto cart</a></p></button></p>\n_jsx(\"span\",{class:\"badge bg-success\",children:\"In Stock\"})})]})})});}export default ProductsMain2;","map":{"version":3,"names":["Link","Rating","React","useEffect","useState","useReducer","useContext","Store","axios","ProductsMain2","props","product","state","ctxDispatch","dispatch","cartItems","cart","addToCartHandler","existItem","find","x","_id","quantity","get","data","countInStock","window","alert","type","payload","slug","image","name","rating","numReviews","description"],"sources":["C:/xampp/htdocs/Đồ án Mã Nguồn Mở/MaNguonMo/DoAn/src/components/mainpages/products/ProductsMain2.js"],"sourcesContent":["import { Link } from 'react-router-dom';\r\nimport Rating from './Rating';\r\nimport React, {useEffect, useState, useReducer, useContext } from 'react'\r\nimport { Store } from '../../../Store';\r\nimport axios from 'axios';\r\n\r\nfunction ProductsMain2(props) {\r\n    const {product} = props;\r\n    const {state, dispatch: ctxDispatch} = useContext(Store);\r\n    const {\r\n        cart: { cartItems},\r\n    } = state;\r\n\r\n    const addToCartHandler = async () => {\r\n        const existItem = cartItems.find((x) => x._id === product._id);\r\n        const quantity = existItem ? existItem.quantity + 1 : 1;\r\n        const {data} = await axios.get(`/api/products/${product._id}`);\r\n        if(data.countInStock < quantity ){\r\n            window.alert('Sorry . Product is out if stock');\r\n            return ;\r\n        }\r\n        ctxDispatch({\r\n            type: 'CART_ADD_ITEM',\r\n            payload: {...product,quantity},\r\n        });\r\n    }\r\n  return (\r\n    <div>\r\n        {/* <h4><Link to={`/products/${product._id}`}>{product.name}</Link></h4> */}\r\n        <div  className=\"col-md-3 new-collections-grid\">\r\n        <div className=\"new-collections-grid1 animated wow slideInUp\" data-wow-delay=\".5s\">\r\n            <div className=\"new-collections-grid1-image\">\r\n                <Link to={`products/${product.slug}`} className=\"product-image\"><img src={product.image} alt={product.name} className=\"img-responsive\" /></Link>\r\n                <div className=\"new-collections-grid1-image-pos\">\r\n                    <Link to={`products/${product.slug}`}>Quick View</Link>\r\n                </div>\r\n                <div className=\"new-collections-grid1-right\">\r\n                    <div className=\"rating\">\r\n                        <Rating rating = {product.rating} numReviews={product.numReviews}></Rating>\r\n                        <div className=\"clearfix\"> </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <h4><Link to={`/product/${product._id}`}>{product.name}</Link></h4>\r\n            <p>{product.description}</p>\r\n            <div className=\"new-collections-grid1-left simpleCart_shelfItem\">\r\n                {product.countInStock <= 0 ? <span class=\"badge bg-success\">on Stock</span>\r\n                :\r\n                    // <p><i>$340</i> <span className=\"item_price\">${product.price}</span><button className='btnAdd' onClick={() => addToCartHandler(product)}><p><a>Add sto cart</a></p></button></p>\r\n                    <span class=\"badge bg-success\">In Stock</span>\r\n                }\r\n            </div>\r\n        </div>\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProductsMain2\r\n"],"mappings":"+eAAA,OAASA,IAAT,KAAqB,kBAArB,CACA,MAAOC,OAAP,KAAmB,UAAnB,CACA,MAAOC,MAAP,EAAeC,SAAf,CAA0BC,QAA1B,CAAoCC,UAApC,CAAgDC,UAAhD,KAAkE,OAAlE,CACA,OAASC,KAAT,KAAsB,gBAAtB,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,wFAEA,QAASC,cAAT,CAAuBC,KAAvB,CAA8B,CAC1B,GAAOC,QAAP,CAAkBD,KAAlB,CAAOC,OAAP,CACA,gBAAuCL,UAAU,CAACC,KAAD,CAAjD,CAAOK,KAAP,aAAOA,KAAP,CAAwBC,WAAxB,aAAcC,QAAd,CACA,GACYC,UADZ,CAEIH,KAFJ,CACII,IADJ,CACYD,SADZ,CAIA,GAAME,iBAAgB,4FAAG,kLACfC,SADe,CACHH,SAAS,CAACI,IAAV,CAAe,SAACC,CAAD,QAAOA,EAAC,CAACC,GAAF,GAAUV,OAAO,CAACU,GAAzB,EAAf,CADG,CAEfC,QAFe,CAEJJ,SAAS,CAAGA,SAAS,CAACI,QAAV,CAAqB,CAAxB,CAA4B,CAFjC,uBAGAd,MAAK,CAACe,GAAN,yBAA2BZ,OAAO,CAACU,GAAnC,EAHA,uCAGdG,IAHc,kBAGdA,IAHc,MAIlBA,IAAI,CAACC,YAAL,CAAoBH,QAJF,0BAKjBI,MAAM,CAACC,KAAP,CAAa,iCAAb,EALiB,wCAQrBd,WAAW,CAAC,CACRe,IAAI,CAAE,eADE,CAERC,OAAO,gCAAMlB,OAAN,MAAcW,QAAQ,CAARA,QAAd,EAFC,CAAD,CAAX,CARqB,uDAAH,kBAAhBL,iBAAgB,0CAAtB,CAaF,mBACE,kCAEI,YAAM,SAAS,CAAC,+BAAhB,uBACA,aAAK,SAAS,CAAC,8CAAf,CAA8D,iBAAe,KAA7E,wBACI,aAAK,SAAS,CAAC,6BAAf,wBACI,KAAC,IAAD,EAAM,EAAE,oBAAcN,OAAO,CAACmB,IAAtB,CAAR,CAAsC,SAAS,CAAC,eAAhD,uBAAgE,YAAK,GAAG,CAAEnB,OAAO,CAACoB,KAAlB,CAAyB,GAAG,CAAEpB,OAAO,CAACqB,IAAtC,CAA4C,SAAS,CAAC,gBAAtD,EAAhE,EADJ,cAEI,YAAK,SAAS,CAAC,iCAAf,uBACI,KAAC,IAAD,EAAM,EAAE,oBAAcrB,OAAO,CAACmB,IAAtB,CAAR,wBADJ,EAFJ,cAKI,YAAK,SAAS,CAAC,6BAAf,uBACI,aAAK,SAAS,CAAC,QAAf,wBACI,KAAC,MAAD,EAAQ,MAAM,CAAInB,OAAO,CAACsB,MAA1B,CAAkC,UAAU,CAAEtB,OAAO,CAACuB,UAAtD,EADJ,cAEI,YAAK,SAAS,CAAC,UAAf,eAFJ,GADJ,EALJ,GADJ,cAaI,iCAAI,KAAC,IAAD,EAAM,EAAE,oBAAcvB,OAAO,CAACU,GAAtB,CAAR,UAAsCV,OAAO,CAACqB,IAA9C,EAAJ,EAbJ,cAcI,mBAAIrB,OAAO,CAACwB,WAAZ,EAdJ,cAeI,YAAK,SAAS,CAAC,iDAAf,UACKxB,OAAO,CAACc,YAAR,EAAwB,CAAxB,cAA4B,aAAM,KAAK,CAAC,kBAAZ,sBAA5B,eAEG;AACA,aAAM,KAAK,CAAC,kBAAZ,sBAJR,EAfJ,GADA,EAFJ,EADF,CA8BD,CAED,cAAehB,cAAf"},"metadata":{},"sourceType":"module"}